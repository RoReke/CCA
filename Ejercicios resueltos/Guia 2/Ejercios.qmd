---
title: "Ejercicios 14 y 15"
format: html
editor: visual
toc: true
lang: es
---

### Ejercicio 1

Se responde al azar un examen diagn√≥stico de 10 preguntas, donde en cada una de ellas

se plantean 4 posibilidades siendo s√≥lo una de ellas correcta.

Si se responden todas las preguntas y las respuestas correctas suman un punto mientras

que las contestadas incorrectamente restan un cuarto de punto, se pide,

a\) Identificar la variable aleatoria asociada.

```{r}
# Es una distribuci√≥n binomial con variable aleatoria "N√∫mero de respuestas correctas"
# Pero para hacer el calculo general necesito estudiar la variable aleatoria "puntaje total" siendo esta: X = k - (1/4) * (10 - k) donde k es el numero de rtas correctas. 
```

b\) Gr√°ficos de la Funci√≥n de Probabilidad y Distribuci√≥n y com√©ntelas.

```{r}
library(ggplot2)
n <- 10
p <- 1/4
k_values <- 0:n
binom_probs <- dbinom(k_values, size = n, prob = p)
binom_data <- data.frame(k_values, binom_probs)
ggplot(binom_data, aes(x = k_values, y = binom_probs)) +
  geom_point() +
  geom_line() +
  labs(title = "Funci√≥n de densidad Binomial",
       x = "N√∫mero de respuestas correctas (k)",
       y = "Probabilidad")

binom_cdf <- pbinom(k_values, size = n, prob = p)
binom_cdf_data <- data.frame(k_values, binom_cdf)
ggplot(binom_cdf_data, aes(x = k_values, y = binom_cdf)) +
  geom_point() +
  geom_line() +
  labs(title = "Funci√≥n de Distribuci√≥n Binomial",
       x = "N√∫mero de respuestas correctas (k)",
       y = "Probabilidad acumulada")
```

c\) La probabilidad de obtener 3 aciertos.

```{r}
dbinom(3, size = n, prob = p)
```

d\) La probabilidad de aprobar.

```{r}
# asumo que se aprueba con 4
# para aprobar necesito tener 4 puntos en total 
# resuelvo esta ecuaci√≥n 4 = k - (1/4) * (10 - k) => necesito 6 resp correctas aprox
pbinom(6, size = n, prob = p, lower.tail = FALSE)
```

e\) ¬øQu√© n√∫mero de aciertos es m√°s probable?

```{r}
library(dplyr)
data <- data.frame(aciertos = 1:10, prob = dbinom(1:10, size = n, prob = p))
data %>% filter(prob == max(prob))
```

f\) ¬øCu√°ntos aciertos debe tener para quedar por encima de la mitad de la clase?

```{r}
library(dplyr)
library(ggplot2)
prob = 0.25

plot_function_densidad <- function(quantil) {
  quantil_r <- qbinom(p = quantil, size = 10, prob = prob)
valores_x <- 0:10
densidad_probabilidad <- dbinom(valores_x,  size = 10, prob = prob)
df <- data.frame(valores_x, densidad_probabilidad)
df_fill <- df %>%
  filter(valores_x <= quantil_r)
ggplot() +
  geom_line(data = df, aes(x = valores_x, y = densidad_probabilidad), color = "blue") +
  geom_area(data = df_fill, aes(x = valores_x, y = densidad_probabilidad), fill = "blue", alpha = 0.3) +
  geom_vline(aes(xintercept = quantil_r), color = "red", linetype = "dashed") +
  labs(
    title = "Funci√≥n de Densidad de Probabilidad Normal",
    x = "Valor en x",
    y = "Densidad de Probabilidad"
  ) +
  theme_minimal()
}
plot_function_densidad(0.5)
```

g\) ¬øY por encima de un tercio de la clase?

```{r}
qbinom(p = 1/3, size = 10, prob = 0.25)
```

### Ejercicio 2

Dada la distribuci√≥n ùêµ(10; 0.4), calcule las siguientes probabilidades, a) ùëÉ\[ùëã ‚â§ 8\] b) ùëÉ\[2 \< ùëã ‚â§ 5\] c) ùëÉ\[ùëã ‚â• 7\]

```{r}
pbinom(8, 10, 0.4)
pbinom(5, 10, 0.4) - pbinom(2, 10, 0.4)
pbinom(7, 10, 0.4, lower.tail = FALSE)
```

### Ejercicio 3

Un conocido fumador gorr√≥n ha explotado tanto a sus compa√±eros que en promedio cada uno de ellos le da un cigarrillo de cada diez veces que √©ste les pide.

a\) ¬øCu√°l es la probabilidad de que consiga 1 cigarrillo en menos de 5 intentos?

```{r}
1 - pbinom(0, 4, 0.1) # al menos 1 cigarrillo. 
```

b\) Si pretende hacer acopio de cigarrillos para el fin de semana, ¬øCu√°ntas veces, en promedio, tendr√° que pedir tabaco para conseguir 20 unidades?

```{r}
20/0.1
```

### Ejercicio 4

Suponga que en los concursos docentes es frecuente que se realice un sorteo p√∫blico extrayendo una serie de temas de un bolillero. Asimismo, imag√≠nese que un concursante prepar√≥ 60 temas entre 100, de los que se seleccionan al azar dos temas. Se pide,

a\) Identificar la variable aleatoria asociada.

```{r}
# cantidad de temas
```

b\) Gr√°ficos de la Funci√≥n de Probabilidad y Distribuci√≥n y com√©ntelas.

c\) La probabilidad de que le salga uno de los temas que lleva preparado.

```{r}
n <- 100   # n√∫mero de elementos en la poblaci√≥n
m <- 60    # n√∫mero de elementos en la poblaci√≥n que tienen la caracter√≠stica de inter√©s
k <- 2     # n√∫mero de elementos que se extraen de la poblaci√≥n
# Calculamos la probabilidad de que se elija al menos uno de los temas que prepar√≥
1 - phyper(0, m, n-m, k)
```

d\) La probabilidad de que le salgan dos de los temas que lleva preparado.

```{r}
phyper(1, m, n-m, k, lower.tail = FALSE)
```

e\) ¬øQu√© ocurre con la probabilidad anterior si aumenta el n√∫mero de temas preparados a 80?

```{r}
phyper(1, 80, n-80, k, lower.tail = FALSE)
```

### Ejercicio 5

En un establecimiento de apuestas deportivas llega en promedio 1 cliente cada 3 minutos.

a\) ¬øCu√°l es la probabilidad de que en un periodo de 5 minutos lleguen m√°s de 5

clientes?

```{r}
#Œª = (1 cliente / 3 minutos) * 5 minutos = 5/3 ‚âà 1.67 clientes en 5 minutos
1 - ppois(5, lambda = 1.67)
```

b\) ¬øCu√°l es la cantidad m√°s probable de llegadas en media hora?

```{r}
#Œª = (1 cliente / 3 minutos) * 30 minutos = 30/3 ‚âà 10 clientes en 30 minutos
```

### Ejercicio 6

Las compa√±√≠as a√©reas acostumbran a reservar m√°s plazas de las existentes en sus

vuelos, dado el porcentaje de anulaciones que se produce. Si el porcentaje promedio de

anulaciones es del 5%.

¬øCu√°ntas reservas deber√° hacer una compa√±√≠a para un vuelo con 200 plazas, si quiere

con una probabilidad del 97 % que todos sus clientes tengan cabida en dicho vuelo?

```{r}
library(ggplot2)

reservas <- 200:220
valores_qbinom <- qbinom(0.97, size = reservas, 0.95, lower.tail = FALSE)
data <- data.frame(Reservas = reservas, Qbinom = valores_qbinom)
interseccion <- data[data$Qbinom >= 200,][1,]

ggplot(data, aes(x = Reservas, y = Qbinom)) +
  geom_point() +
  geom_point(data = interseccion, aes(x = Reservas, y = Qbinom), color = "green", size = 4, shape = 21) +
  geom_hline(yintercept = 200, linetype = "dashed", color = "red") +
  annotate("text", x = interseccion$Reservas, y = interseccion$Qbinom, label = paste("Intersecci√≥n =", interseccion$Reservas), vjust = -1.5, color = "darkgreen") +
  theme_minimal() +
  labs(title = "Valores de qbinom en funci√≥n del tama√±o de reserva",
       x = "Tama√±o de reserva",
       y = "Valores de qbinom") +
  coord_cartesian(ylim = c(190, max(valores_qbinom) + 10))

```

### Ejercicio 7

El servicio de reclamos de una asociaci√≥n de consumidores recibe en promedio 3 quejas

por hora.

a\) Calcule la probabilidad de que en 1 hora no reciba ning√∫n reclamo.

```{r}
dpois(0, 3)
```

b\) Calcule la probabilidad de que en 2 horas reciba entre 2 y 6 reclamos.

```{r}
ppois(6, 6) - ppois(1, 6)
```
