---
title: "Ejercicios 14 y 15"
format: html
editor: visual
toc: true
lang: es
---

### Ejercicio 1

Se responde al azar un examen diagn√≥stico de 10 preguntas, donde en cada una de ellas

se plantean 4 posibilidades siendo s√≥lo una de ellas correcta.

Si se responden todas las preguntas y las respuestas correctas suman un punto mientras

que las contestadas incorrectamente restan un cuarto de punto, se pide,

a\) Identificar la variable aleatoria asociada.

```{r}
# Es una distribuci√≥n binomial con variable aleatoria "N√∫mero de respuestas correctas"
# Pero para hacer el calculo general necesito estudiar la variable aleatoria "puntaje total" siendo esta: X = k - (1/4) * (10 - k) donde k es el numero de rtas correctas. 
```

b\) Gr√°ficos de la Funci√≥n de Probabilidad y Distribuci√≥n y com√©ntelas.

```{r}
library(ggplot2)
n <- 10
p <- 1/4
k_values <- 0:n
binom_probs <- dbinom(k_values, size = n, prob = p)
binom_data <- data.frame(k_values, binom_probs)
ggplot(binom_data, aes(x = k_values, y = binom_probs)) +
  geom_point() +
  geom_line() +
  labs(title = "Funci√≥n de densidad Binomial",
       x = "N√∫mero de respuestas correctas (k)",
       y = "Probabilidad")

binom_cdf <- pbinom(k_values, size = n, prob = p)
binom_cdf_data <- data.frame(k_values, binom_cdf)
ggplot(binom_cdf_data, aes(x = k_values, y = binom_cdf)) +
  geom_point() +
  geom_line() +
  labs(title = "Funci√≥n de Distribuci√≥n Binomial",
       x = "N√∫mero de respuestas correctas (k)",
       y = "Probabilidad acumulada")
```

c\) La probabilidad de obtener 3 aciertos.

```{r}
dbinom(3, size = n, prob = p)
```

d\) La probabilidad de aprobar.

```{r}
# asumo que se aprueba con 4
# para aprobar necesito tener 4 puntos en total 
# resuelvo esta ecuaci√≥n 4 = k - (1/4) * (10 - k) => necesito 6 resp correctas aprox
pbinom(6, size = n, prob = p, lower.tail = FALSE)
```

e\) ¬øQu√© n√∫mero de aciertos es m√°s probable?

```{r}
library(dplyr)
data <- data.frame(aciertos = 1:10, prob = dbinom(1:10, size = n, prob = p))
data %>% filter(prob == max(prob))
```

f\) ¬øCu√°ntos aciertos debe tener para quedar por encima de la mitad de la clase?

```{r}
library(dplyr)
library(ggplot2)
prob = 0.25

plot_function_densidad <- function(quantil) {
  quantil_r <- qbinom(p = quantil, size = 10, prob = prob)
valores_x <- 0:10
densidad_probabilidad <- dbinom(valores_x,  size = 10, prob = prob)
df <- data.frame(valores_x, densidad_probabilidad)
df_fill <- df %>%
  filter(valores_x <= quantil_r)
ggplot() +
  geom_line(data = df, aes(x = valores_x, y = densidad_probabilidad), color = "blue") +
  geom_area(data = df_fill, aes(x = valores_x, y = densidad_probabilidad), fill = "blue", alpha = 0.3) +
  geom_vline(aes(xintercept = quantil_r), color = "red", linetype = "dashed") +
  labs(
    title = "Funci√≥n de Densidad de Probabilidad Normal",
    x = "Valor en x",
    y = "Densidad de Probabilidad"
  ) +
  theme_minimal()
}
plot_function_densidad(0.5)
```

g\) ¬øY por encima de un tercio de la clase?

```{r}
qbinom(p = 1/3, size = 10, prob = 0.25)
```

### Ejercicio 2

Dada la distribuci√≥n ùêµ(10; 0.4), calcule las siguientes probabilidades, a) ùëÉ\[ùëã ‚â§ 8\] b) ùëÉ\[2 \< ùëã ‚â§ 5\] c) ùëÉ\[ùëã ‚â• 7\]

```{r}
pbinom(8, 10, 0.4)
pbinom(5, 10, 0.4) - pbinom(2, 10, 0.4)
pbinom(7, 10, 0.4, lower.tail = FALSE)
```

### Ejercicio 3

Un conocido fumador gorr√≥n ha explotado tanto a sus compa√±eros que en promedio cada uno de ellos le da un cigarrillo de cada diez veces que √©ste les pide.

a\) ¬øCu√°l es la probabilidad de que consiga 1 cigarrillo en menos de 5 intentos?

```{r}
1 - pbinom(0, 4, 0.1) # al menos 1 cigarrillo. 
```

b\) Si pretende hacer acopio de cigarrillos para el fin de semana, ¬øCu√°ntas veces, en promedio, tendr√° que pedir tabaco para conseguir 20 unidades?

```{r}
20/0.1
```

### Ejercicio 4

Suponga que en los concursos docentes es frecuente que se realice un sorteo p√∫blico extrayendo una serie de temas de un bolillero. Asimismo, imag√≠nese que un concursante prepar√≥ 60 temas entre 100, de los que se seleccionan al azar dos temas. Se pide,

a\) Identificar la variable aleatoria asociada.

```{r}
# cantidad de temas
```

b\) Gr√°ficos de la Funci√≥n de Probabilidad y Distribuci√≥n y com√©ntelas.

c\) La probabilidad de que le salga uno de los temas que lleva preparado.

```{r}
n <- 100   # n√∫mero de elementos en la poblaci√≥n
m <- 60    # n√∫mero de elementos en la poblaci√≥n que tienen la caracter√≠stica de inter√©s
k <- 2     # n√∫mero de elementos que se extraen de la poblaci√≥n
# Calculamos la probabilidad de que se elija al menos uno de los temas que prepar√≥
1 - phyper(0, m, n-m, k)
```

d\) La probabilidad de que le salgan dos de los temas que lleva preparado.

```{r}
phyper(1, m, n-m, k, lower.tail = FALSE)
```

e\) ¬øQu√© ocurre con la probabilidad anterior si aumenta el n√∫mero de temas preparados a 80?

```{r}
phyper(1, 80, n-80, k, lower.tail = FALSE)
```

### Ejercicio 5

En un establecimiento de apuestas deportivas llega en promedio 1 cliente cada 3 minutos.

a\) ¬øCu√°l es la probabilidad de que en un periodo de 5 minutos lleguen m√°s de 5

clientes?

```{r}
#Œª = (1 cliente / 3 minutos) * 5 minutos = 5/3 ‚âà 1.67 clientes en 5 minutos
1 - ppois(5, lambda = 1.67)
```

b\) ¬øCu√°l es la cantidad m√°s probable de llegadas en media hora?

```{r}
#Œª = (1 cliente / 3 minutos) * 30 minutos = 30/3 ‚âà 10 clientes en 30 minutos
```

### Ejercicio 6

Las compa√±√≠as a√©reas acostumbran a reservar m√°s plazas de las existentes en sus

vuelos, dado el porcentaje de anulaciones que se produce. Si el porcentaje promedio de

anulaciones es del 5%.

¬øCu√°ntas reservas deber√° hacer una compa√±√≠a para un vuelo con 200 plazas, si quiere

con una probabilidad del 97 % que todos sus clientes tengan cabida en dicho vuelo?

```{r}
library(ggplot2)

reservas <- 200:220
valores_qbinom <- qbinom(0.97, size = reservas, 0.95, lower.tail = FALSE)
data <- data.frame(Reservas = reservas, Qbinom = valores_qbinom)
interseccion <- data[data$Qbinom >= 200,][1,]

ggplot(data, aes(x = Reservas, y = Qbinom)) +
  geom_point() +
  geom_point(data = interseccion, aes(x = Reservas, y = Qbinom), color = "green", size = 4, shape = 21) +
  geom_hline(yintercept = 200, linetype = "dashed", color = "red") +
  annotate("text", x = interseccion$Reservas, y = interseccion$Qbinom, label = paste("Intersecci√≥n =", interseccion$Reservas), vjust = -1.5, color = "darkgreen") +
  theme_minimal() +
  labs(title = "Valores de qbinom en funci√≥n del tama√±o de reserva",
       x = "Tama√±o de reserva",
       y = "Valores de qbinom") +
  coord_cartesian(ylim = c(190, max(valores_qbinom) + 10))

```

### Ejercicio 7

El servicio de reclamos de una asociaci√≥n de consumidores recibe en promedio 3 quejas

por hora.

a\) Calcule la probabilidad de que en 1 hora no reciba ning√∫n reclamo.

```{r}
dpois(0, 3)
```

b\) Calcule la probabilidad de que en 2 horas reciba entre 2 y 6 reclamos.

```{r}
ppois(6, 6) - ppois(1, 6)
```

### Ejercicio 8

En una pecera hay 10 peces machos y 8 hembras, si se extraen aleatoriamente 5 peces, calcule la probabilidad de que 3 sean machos y 2 hembras.

```{r}
# x es el n√∫mero de elementos de inter√©s que se extraen (en este caso, 3 machos y 2 hembras).
# m es el n√∫mero de elementos de inter√©s en la poblaci√≥n (en este caso, el n√∫mero de machos, que es 10).
# n es el n√∫mero de elementos que no son de inter√©s en la poblaci√≥n (en este caso, el n√∫mero de hembras, que es 8).
# k es el n√∫mero de elementos que se extraen (en este caso, 5).
dhyper(x = 3, m = 10, n = 8, k = 5)
```

### Ejercicio 9

Un jugador apuesta \$5 por tirada a un n√∫mero de los 37 que componen la ruleta, si acierta, gana \$180. Calcular los beneficios esperados al cabo de 100 jugadas.

```{r}
# Probabilidades
prob_ganar <- 1/37
prob_perder <- 36/37

# Ganancias y p√©rdidas
ganancia <- 175
perdida <- -5

# Beneficio esperado por tirada
beneficio_esperado_tirada <- (prob_ganar * ganancia) + (prob_perder * perdida)

# Beneficio esperado despu√©s de 100 jugadas
beneficio_esperado_100 <- beneficio_esperado_tirada * 100
beneficio_esperado_100

```

### Ejercicio 10

El servicio de micros entre Retiro y la Ciudad de la Plata tiene salidas cada media hora entre las 6 am y las 12 pm. Una persona se olvid√≥ el reloj en su casa, llega a la estaci√≥n de Retiro. Se pide,

a\) La variable aleatoria adecuada para esta situaci√≥n.

```{r}
#el tiempo de espera en minutos hasta la pr√≥xima salida del micro
```

Gr√°ficos de la Funci√≥n de Densidad y Distribuci√≥n y com√©ntelas.

```{r}
# Funci√≥n de densidad
x <- seq(0, 30, length=1000) # Valores de x en el rango [0, 360]
y <- dunif(x, min=0, max=360) # Funci√≥n de densidad uniforme
plot(x, y, type="l", xlab="Tiempo de espera (minutos)", ylab="Densidad de probabilidad")

# Funci√≥n de distribuci√≥n acumulada
z <- punif(x, min=0, max=30) # Funci√≥n de distribuci√≥n uniforme
plot(x, z, type="l", xlab="Tiempo de espera (minutos)", ylab="Probabilidad acumulada")

```

c)  ¬øCu√°l es su media? ¬øy su mediana? ¬øy su moda?

```{r}
#  30 minutos
```

d)  La probabilidad de que espere menos de 10 minutos.

```{r}
punif(10, min = 0, max = 30)
```

e)  La probabilidad de que espere m√°s de 15 minutos, pero menos de 20.

```{r}
punif(20, min = 0, max = 30) - punif(15, min = 0, max = 30)
```

f)  ¬øCu√°l es la probabilidad de que espere exactamente 11 minutos y medio

```{r}
dunif(11.5, min = 0, max = 30)
```

### Ejercicio 11

Se sabe que las bombillas de bajo consumo de 14 w tienen una vida √∫til media de 10000 horas, mientras que las bombillas cl√°sicas por incandescencia de 60 w tienen una vida √∫til media de 1000 horas. Si cada d√≠a se encienden unas 4 horas, en esta situaci√≥n a) Defina la variable aleatoria asociada.

```{r}
# vida √∫til en horas de las bombillas.
```

b)  Obtenga los gr√°ficos de la Funci√≥n de Densidad y Distribuci√≥n y com√©ntelas.

```{r}
# Datos de vida √∫til de las bombillas
vida_util_ahorro_energia <- c(800, 1200, 1100, 900, 1500, 1000, 1300, 850, 950, 1000)
vida_util_incandescente <- c(400, 300, 200, 500, 350, 600, 250, 400, 450, 300)

# Funci√≥n de densidad de probabilidad exponencial
pdf_exponencial <- function(x, lambda) {
  return(lambda * exp(-lambda * x))
}

# Funci√≥n de distribuci√≥n de probabilidad exponencial
cdf_exponencial <- function(x, lambda) {
  return(1 - exp(-lambda * x))
}

# Par√°metro lambda para la distribuci√≥n exponencial
lambda_ahorro_energia <- 1/mean(vida_util_ahorro_energia)
lambda_incandescente <- 1/mean(vida_util_incandescente)

# Rango de valores para la funci√≥n de densidad y distribuci√≥n
rango <- seq(0, 2000, length.out = 500)

# Gr√°fico de la funci√≥n de densidad de probabilidad exponencial para las bombillas de ahorro de energ√≠a
plot(rango, pdf_exponencial(rango, lambda_ahorro_energia), type = "l", col = "blue",
     main = "Funci√≥n de densidad de probabilidad exponencial", xlab = "Vida √∫til (horas)", ylab = "Densidad de probabilidad")
lines(rango, pdf_exponencial(rango, lambda_incandescente), col = "red")
legend("topright", legend = c("Ahorro de energ√≠a", "Incandescente"), col = c("blue", "red"), lty = 1)

# Gr√°fico de la funci√≥n de distribuci√≥n de probabilidad exponencial para las bombillas de ahorro de energ√≠a
plot(rango, cdf_exponencial(rango, lambda_ahorro_energia), type = "l", col = "blue",
     main = "Funci√≥n de distribuci√≥n de probabilidad exponencial", xlab = "Vida √∫til (horas)", ylab = "Probabilidad acumulada")
lines(rango, cdf_exponencial(rango, lambda_incandescente), col = "red")
legend("bottomright", legend = c("Ahorro de energ√≠a", "Incandescente"), col = c("blue", "red"), lty = 1)

```

c)  ¬øCu√°l es su media? ¬øy su mediana?

```{r}
lambda_bajo_consumo <- 1/10000
lambda_incandescencia <- 1/1000
media_bajo_consumo <- 1/lambda_bajo_consumo
media_incandescencia <- 1/lambda_incandescencia
mediana_bajo_consumo <- log(2)/lambda_bajo_consumo
mediana_incandescencia <- log(2)/lambda_incandescencia
```

d)  ¬øCu√°l es la probabilidad de que despu√©s de un a√±o est√©n funcionando?.

```{r}
anio <- 365*4 #1460 horas
1 - pexp(anio, lambda_bajo_consumo)
1 - pexp(anio, lambda_incandescencia)
```

\### Ejercicio 12

Durante la Segunda Guerra Mundial los alemanes bombardearon repetidas veces Londres. Los expertos demostraron que se trataba de bombardeos indiscriminados y que ca√≠an en cada acci√≥n y en promedio 2 bombas por cada cuadr√≠cula de 100 metros de lado. En vista a lo anterior, calcule la probabilidad de que en una cierta cuadr√≠cula de 50 metros de lado no haya ca√≠do ninguna bomba durante un bombardeo

```{r}
#Para resolver este problema, podemos utilizar la distribuci√≥n de Poisson, que es #adecuada para modelar eventos que ocurren de manera aleatoria e independiente en #un espacio fijo. 
#
lambda <- 0.5 # bombas
dpois(0, lambda)

```

### Ejercicio 13

Dada una Distribuci√≥n Normal de Mediana igual a 3 y una varianza igual a 9, calcule las siguientes probabilidades, a) ùëÉ\[2 ‚â§ ùëã ‚â§ 5\] b) ùëÉ\[ùëã ‚â• 3\] c) ùëÉ\[ùëã ‚â§ ‚àí2\]\

```{r}
media <- 3
desviacion_estandar <- 3
probabilidad_a <- pnorm(5, mean = media, sd = desviacion_estandar) - pnorm(2, mean = media, sd = desviacion_estandar)
probabilidad_a
probabilidad_b <- 1 - pnorm(3, mean = media, sd = desviacion_estandar)
probabilidad_b
probabilidad_c <- pnorm(-2, mean = media, sd = desviacion_estandar)
probabilidad_c
```

### Ejercicio 14

Un programa de televisi√≥n que premia aquellos participantes que llaman dando la respuesta correcta de un concurso, atiende 1 de cada 10 llamadas que se realizan.

a\) ¬øQu√© n√∫mero promedio de llamadas se tendr√°n que realizar para ser atendido?

```{r}
p <- 0.1  # Probabilidad de √©xito
1/p
```

b\) ¬øCu√°l es la probabilidad de ser atendido a la primera?

```{r}
k <- 1   # N√∫mero de √©xitos que nos interesa calcular
dbinom(k, size = 1, prob = p)
```

\### Ejercicio 15

Calcule en los siguientes casos el valor de ùëé, sabiendo que ùëã\~ùëÅ(1,5). a) ùëÉ\[0 ‚â§ ùëã ‚â§ ùëé\] = 0,28 b) ùëÉ\[1 ‚àí ùëé ‚â§ ùëã ‚â§ 1 + ùëé\] = 0,65

```{r}
media <- 1
desv <- sqrt(5)
prob <- 0.28
x = 1
z = 0
while(0.28 - z > 0.01) {
  x <- x + 0.01
  z <- pnorm(x, mean = media, sd = desv) - pnorm(0, mean = media, sd = desv)
}
x
pnorm(1 + x, mean = media, sd = desv) - pnorm(1 - x, mean = media, sd = desv)
```

### Ejercicio 16

Se sabe que la alarma de un reloj saltar√° en cualquier momento entre las siete y las ocho de la ma√±ana. Si el propietario del reloj se despierta al o√≠r dicha alarma y necesita, como m√≠nimo, veinticinco minutos para arreglarse y llegar al trabajo, a) ¬øCu√°l es la probabilidad de que llegue antes de las ocho?

```{r}
probabilidad <- (60 - 25)/60
probabilidad
```

b)  Si el due√±o del reloj sigue programando el reloj de la misma manera durante 10 d√≠as, calcule el n√∫mero m√°s probable de d√≠as en que llegar√° despu√©s de las ocho.

```{r}
10*probabilidad
```

### Ejercicio 17

De una tribu ind√≠gena se sabe que los hombres tienen una estatura que se distribuye normalmente con un valor esperado igual a 1,70 y desviaci√≥n t√≠pica ùúé. Si a trav√©s de estudios realizados se conoce que la probabilidad de que su estatura sea mayor a 1,80 es 0,12.

Calcule la probabilidad de que un individuo elegido al azar mida entre 1,65 y 1,75.

```{r}
media <- 1.70
x <- 1.80
#z <- (x - media) / sigma
# el valor correspondiente al percentil (1 - 0,12), que es el valor de la variable normal est√°ndar que tiene una probabilidad acumulada del 88%:

z <- qnorm(1 - 0.12)
sigma <- (x - media) / z
x1 <- 1.65
x2 <- 1.75
z1 <- (x1 - media) / sigma
z2 <- (x2 - media) / sigma

p <- pnorm(z2) - pnorm(z1)
p
```

### Ejercicio 18 (!)

Calcule la probabilidad de obtener m√°s de 200 seises en 1200 lanzamientos de un dado no trucado.

```{r}
n <- 1200
p <- 1/6
1 - pbinom(200, n, p)

simular_lanzamientos <- function(n_lanzamientos) {
  dados <- sample(1:6, n_lanzamientos, replace = TRUE)
  sum(dados == 6)
}
set.seed(123)
n_simulaciones <- 10000
n_lanzamientos <- 1200

resultados <- replicate(n_simulaciones, simular_lanzamientos(n_lanzamientos))

proporcion_mayor_200 <- mean(resultados > 200)
proporcion_mayor_200
```

### Ejercicio 19

Genere muestras de tama√±o 10, 100, 500 y 1000 de una poblaci√≥n que sigue una Distribuci√≥n Normal con valor modal de 3,5 y desv√≠o est√°ndar igual a 2. Estudie el comportamiento de la media y el desv√≠o est√°ndar en las cuatro muestras

```{r}
set.seed(123)  # fijar la semilla para replicabilidad

mu <- 3.5
sigma <- 2

muestra_10 <- rnorm(10, mu, sigma)
muestra_100 <- rnorm(100, mu, sigma)
muestra_500 <- rnorm(500, mu, sigma)
muestra_1000 <- rnorm(1000, mu, sigma)
media_10 <- mean(muestra_10)
media_100 <- mean(muestra_100)
media_500 <- mean(muestra_500)
media_1000 <- mean(muestra_1000)

desvio_10 <- sd(muestra_10)
desvio_100 <- sd(muestra_100)
desvio_500 <- sd(muestra_500)
desvio_1000 <- sd(muestra_1000)
```

### Ejercicio 20

Obtenga una muestra aleatoria de tama√±o 50 para una caracter√≠stica poblacional que sigue una Distribuci√≥n Binomial de par√°metros ùëõ = 12 y ùëù = 0,70. Calcule su valor esperado y desv√≠o est√°ndar compar√°ndolas con los respectivos valores poblacionales. Adem√°s, represente los datos mediante un diagrama de barras y compare los resultados con los observados en la gr√°fica de la funci√≥n de probabilidad de la Distribuci√≥n Binomial. ¬øQu√© ocurre si se aumenta el tama√±o de la muestra a 500?

```{r}

set.seed(123)  # fijar la semilla para replicabilidad

n <- 12
p <- 0.7

muestra_50 <- rbinom(50, n, p)
muestra_500 <- rbinom(500, n, p)
media_muestra_50 <- mean(muestra_50)
desvio_muestra_50 <- sqrt(mean((muestra_50 - media_muestra_50)^2))
media_poblacional <- n * p
desvio_poblacional <- sqrt(n * p * (1 - p))
media_muestra_500 <- mean(muestra_500)
desvio_muestra_500 <- sqrt(mean((muestra_500 - media_muestra_500)^2))
media_muestra_500
media_muestra_50
media_poblacional
library(ggplot2)

datos <- rbind(data.frame(Muestra = "Muestra 50", Valor = muestra_50),
               data.frame(Muestra = "Muestra 500", Valor = muestra_500))

ggplot(datos, aes(x = Valor, fill = Muestra)) +
  geom_histogram(position = "dodge", bins = 10, alpha = 0.5) +
  ggtitle("Comparaci√≥n de las muestras") +
  xlab("Valor") +
  ylab("Frecuencia") +
  scale_fill_manual(values = c("blue", "red")) +
  theme(plot.title = element_text(hjust = 0.5))

```

### Ejercicio 21

Un liquidador de siniestros revisa las p√≥lizas de seguros de autom√≥viles y sabe que solamente el 12% de las p√≥lizas no sufrieron siniestros.

a\) Calcular la probabilidad de que tenga que revisar 18 p√≥lizas para encontrar 3 que no tengan siniestros.

```{r}
n <- 18
p <- 0.12
x <- 3

probabilidad <- dbinom(x, n, p)
probabilidad
```

b\) Calcular la probabilidad de que tenga que revisar 7 p√≥lizas para encontrar una que no sufrido siniestro.

```{r}
n <- 7
p <- 0.12
x <- 1

probabilidad <- dbinom(x, n, p)
probabilidad
```

c) ¬øCu√°ntas p√≥lizas espera tener que revisar para encontrar 24 que no tengan
siniestro?

```{r}
24/p
```

d) ¬øCu√°ntas p√≥lizas espera tener que revisar para encontrar 22 que tengan siniestro?

```{r}
22/(1-p)
```

### Ejercicio 22

El 80% de los clientes de una Entidad Financiera deben recurrir a sobregiros al menos
una vez al a√±o. Si se seleccionan aleatoriamente 100 cuentas corrientes, hallar la
probabilidad de que hayan recurrido a sobregiros:
a) Entre 10 y 15
b) M√°s de 8
c) Menos de 8

